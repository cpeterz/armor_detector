#robomaster校内赛视觉组单项赛结构

###1.主要任务

整个代码主要任务是进行 **识别装甲板**  ， **测距**和 **目标预测** ，外加一定的**逻辑判断**来确定是否进行击打。

### 2. 主要思路

###2.1 识别

通过传统视觉处理方法，利用赛方给的  `getImg`  函数获取图像，对图像进行 ==降噪== ， ==二值化== 处理，利用装甲板上的两个灯条特征进行识别，（平行，长度等条件）。

###**2.2** **测距**

先利用赛方给的矩阵对图像进行==矫正== ， 对图像进行==单目测距==。

### 2.3 预测

使用 ==卡尔曼算法==对目标的运动进行解算，预测该目标单位时间后的位置，并将该位置发给控制函数。

### 2.4 逻辑判断

逻辑判断主要通过目标检测和预测是否成功来判断是否发弹，如果未检测到目标则不发射弹丸，如果检测到了则对预测位置发射一定数量的弹丸（弹丸数量考虑预测的时间长度，目标距离和弹丸速度）。

## 3.逻辑图示

```flow
开始=>start: 识别装甲板
结束=>end: 继续循环
输入=>inputoutput: getImg()  获取图像
条件1=>condition: 是否识别到装甲板？
操作1=>operation: 测距
操作2=>operation: 预测
条件2=>condition: 解算当前位姿与目标位姿差距，结合其他条件判断是否移动云台并发射弹丸
操作3=>operation: 向控制发送位姿
操作4=>operation: 发射子弹

开始 -> 输入->条件1(yes)->操作1->操作2->条件2(yes)->操作3->操作4->结束
条件1(no)->结束
条件2(no)->结束
```

